<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Blood Pressure Analysis Project</title>
  <style>
    body { font-family:'Poppins', sans-serif; background:#f9f9f9; color:#333; margin:0; padding:20px; line-height:1.7; }
    nav { background:#111; padding:15px; text-align:center; }
    nav a { color:white; margin:0 15px; text-decoration:none; font-weight:bold; }
    nav a:hover { color:#fda085; transition:0.3s; }
    section { margin-bottom:40px; }
    h1, h2 { color:#111; text-align:center; }
    pre { background:#eee; padding:15px; border-radius:10px; overflow-x:auto; }
    figure { margin: 30px 0; text-align:center; }
    figcaption { font-size:0.9rem; color:#555; margin-top:5px; }
    img { max-width:80%; border-radius:10px; display:block; margin:0 auto; }
    table { border-collapse:collapse; width:100%; text-align:center; margin-top:20px; }
    table, th, td { border:1px solid #ccc; }
    th { background:#f2f2f2; padding:8px; }
    td { padding:8px; }
    p.center { text-align:center; }
    code, pre code { font-family:monospace; }
  </style>
</head>
<body>

  <!-- Navigation -->
  <nav>
    <a href="index.html">Portfolio</a>
    <a href="cv.html">CV</a>
  </nav>

  <h1>Blood Pressure Analysis Project</h1>

  <section>
    <p>
      This project explores the relationship between blood pressure (BP, in mm Hg) and several explanatory variables in 20 individuals with high blood pressure. The predictors include age, weight, body surface area (BSA), duration of hypertension, basal pulse, and stress index. The main goal is to identify which factors significantly influence blood pressure and construct predictive models.
    </p>
  </section>

  <section>
    <h2>Initial Data Analysis</h2>
    <p>
      The initial analysis included numerical and graphical summaries. There were 20 observations and 8 variables. No missing values were found. Figures 1–3 show the distributions and relationships among explanatory variables.
    </p>

    <pre><code>
library(ggplot2)
library(leaps)
library(faraway)
bloodData <- read.table('blood.txt', header=T)
bloodData$Pt <- NULL
str(bloodData)
pairs(bloodData[,1:7], pch=1, cex=0.9)
cor(bloodData)
    </code></pre>
  </section>

  <figure>
    <img src="images/1.dataanalis.jpeg" alt="Overview of explanatory variables">
    <figcaption>Figure 1: Overview of explanatory variables.</figcaption>
  </figure>

  <figure>
    <img src="images/1.first.jpeg" alt="Kernel density and index plot">
    <figcaption>Figure 2: Kernel density (left) and index plot (right).</figcaption>
  </figure>

  <figure>
    <img src="images/1.corrplot.jpeg" alt="Pairwise scatter plot">
    <figcaption>Figure 3: Pairwise scatter plot to detect potential collinearity between variables.</figcaption>
  </figure>

  <section>
    <h2>Regression Analysis</h2>
    <p>
      Six simple linear regression models were fitted with BP as the response and each predictor individually. Model 2 (Weight) showed the highest R² value and was selected as the best simple model.
    </p>

    <pre><code>
mdl <- lm(BP ~ Age, data=bloodData)
mdl2 <- lm(BP ~ Weight, data=bloodData)
mdl3 <- lm(BP ~ BSA, data=bloodData)   
mdl4 <- lm(BP ~ Dur, data=bloodData)    #no significant 
mdl5 <- lm(BP ~ Pulse, data=bloodData)
mdl6 <- lm(BP ~ Stress, data=bloodData) #no significant 

'check the models'
summary(mdl) 
summary(mdl2) #*** 
summary(mdl3) #*** 
summary(mdl4)  
summary(mdl5)
summary(mdl6) 

#Find a model with a high adjusted R2
# For mdl2 
res <- resid(mdl2)
hist(res)
#produce residual vs. fitted plot
plot(fitted(mdl2), res,  main = "Residuals vs Fitted" ,ylab="residual")
#add a horizontal line at 0 
abline(0,0)
qqplot(bloodData$Weight,bloodData$BP, xlab = "test x", ylab = "test y", main = "Q-Q Plot")

# Visualise the model together with data
par(mfrow=c(1,2))
plot(BP ~ Weight, data = bloodData, main="Model2 together with the data")
abline(mdl2)
    </code></pre>

    <table>
      <thead>
        <tr>
          <th>Model</th><th>Intercept</th><th>β₁</th><th>R²</th>
        </tr>
      </thead>
      <tbody>
        <tr><td>1 (Age)</td><td>44.46</td><td>1.43</td><td>0.4344</td></tr>
        <tr><td>2 (Weight)</td><td>2.21</td><td>1.20</td><td>0.9026</td></tr>
        <tr><td>3 (BSA)</td><td>45.18</td><td>34.44</td><td>0.7497</td></tr>
        <tr><td>4 (Dur)</td><td>109.24</td><td>0.74</td><td>0.0858</td></tr>
        <tr><td>5 (Pulse)</td><td>42.32</td><td>1.03</td><td>0.5204</td></tr>
        <tr><td>6 (Stress)</td><td>112.72</td><td>0.024</td><td>0.0269</td></tr>
      </tbody>
    </table>
  </section>

  <figure>
    <img src="images/residualfitted.jpeg" alt="Residuals vs Fitted">
    <figcaption>Figure 4: Residuals vs fitted values for Model 2.</figcaption>
  </figure>

  <figure>
    <img src="images/buppgift.jpeg" alt="Regression line with observed values">
    <figcaption>Figure 5: Regression line from Model 2 together with observed data.</figcaption>
  </figure>


<section>
  <h2>Parameter Estimation for Model (d)</h2>
  <p>
    The estimated parameters <code>β̂</code> for each predictor in Model (d) are shown in Table 3. 
    We can see that <code>β̂₅</code> has a negative impact in Model (d). 
    Apart from that, all <code>β̂</code> values seem reasonable and consistent with expectations.
  </p>

  <h3>Table 3: Estimated <code>β̂</code> values for Model (d)</h3>
  <table>
    <thead>
      <tr>
        <th>Model</th>
        <th>Intercept</th>
        <th>β̂₁</th>
        <th>β̂₂</th>
        <th>β̂₃</th>
        <th>β̂₄</th>
        <th>β̂₅</th>
        <th>β̂₆</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>Model (d)</td>
        <td>-12.879</td>
        <td>0.7032</td>
        <td>0.9699</td>
        <td>3.7764</td>
        <td>0.06838</td>
        <td>-0.0844</td>
        <td>0.00557</td>
      </tr>
    </tbody>
  </table>

  <p>
    The corresponding p-values for each parameter, based on the t-test, are presented in Table 4.
  </p>

  <h3>Table 4: p-values for each parameter in the full model</h3>
  <table>
    <thead>
      <tr>
        <th>Parameter</th>
        <th>t-test p-value</th>
      </tr>
    </thead>
    <tbody>
      <tr><td>Intercept</td><td>0.000229</td></tr>
      <tr><td>β̂₁</td><td>2.76e-09</td></tr>
      <tr><td>β̂₂</td><td>1.02e-09</td></tr>
      <tr><td>β̂₃</td><td>0.0327</td></tr>
    </tbody>
  </table>
</section>

    <pre><code>
summary(mdl) #**
summary(mdl2) #*** 
summary(mdl3) #*** 
summary(mdl4)  
summary(mdl5)
summary(mdl6)   

#confint(mdl2, level=0.99)
#Confint(mdl3, level=0.99)

#d) Multiple linear regression- with all the predictors

mdlFULL <- lm(BP ~ ., data=bloodData)  #
summary(mdlFULL)
    </code></pre>

  
  <section>
    <h2>Model Selection (BIC and VIF)</h2>
    <p>Based on BIC, the final suggested model is:</p>
    <p class="center"><code>Ŷ = -13.67 + 0.70·Age + 0.91·Weight + 4.63·BSA</code></p>

    <h3>Table 6: p-values for predictors (BIC model)</h3>
    <table>
      <thead><tr><th>Predictor</th><th>p-value</th></tr></thead>
      <tbody>
        <tr><td>Intercept</td><td>9.42e-05</td></tr>
        <tr><td>Age</td><td>3.00e-11</td></tr>
        <tr><td>Weight</td><td>3.20e-12</td></tr>
        <tr><td>BSA</td><td>0.00776</td></tr>
      </tbody>
    </table>

    <h3>Table 7: Variance Inflation Factors (full model)</h3>
    <table>
      <thead><tr><th>Age</th><th>Weight</th><th>BSA</th><th>Dur</th><th>Pulse</th><th>Stress</th></tr></thead>
      <tbody><tr><td>1.766</td><td>8.741</td><td>5.463</td><td>1.254</td><td>4.547</td><td>2.116</td></tr></tbody>
    </table>

    <p>After removing Weight, the reduced model shows improved multicollinearity:</p>
    <h3>Table 8: VIF (reduced model)</h3>
    <table>
      <thead><tr><th>Age</th><th>BSA</th><th>Dur</th><th>Pulse</th><th>Stress</th></tr></thead>
      <tbody><tr><td>1.704</td><td>1.428</td><td>1.237</td><td>2.361</td><td>1.503</td></tr></tbody>
    </table>

    <p class="center"><code>Ŷ = 6.21 + 0.57·Age + 24.55·BSA + 0.08·Dur + 0.46·Pulse − 0.02·Stress</code></p>
  </section>

  <section>
    <h2>Model Comparison</h2>
    <h3>Table 9: Model comparison statistics</h3>
    <table>
      <thead><tr><th>Model</th><th>AIC</th><th>R²<sub>adj</sub></th><th>F-test p-value</th></tr></thead>
      <tbody>
        <tr><td>(b)</td><td>82.82</td><td>0.9026</td><td>1.528e-10</td></tr>
        <tr><td>(d)</td><td>28.21</td><td>0.9963</td><td>6.395e-15</td></tr>
        <tr><td>(e)</td><td>29.19</td><td>0.9945</td><td>&lt; 2.2e-16</td></tr>
        <tr><td>(f)</td><td>85.27</td><td>0.9278</td><td>1.921e-07</td></tr>
      </tbody>
    </table>

    <h3>Table 10: VIF (Model d)</h3>
    <table>
      <thead><tr><th>Age</th><th>BSA</th><th>Weight</th></tr></thead>
      <tbody><tr><td>1.202</td><td>4.404</td><td>4.287</td></tr></tbody>
    </table>
  </section>

  <section>
    <h2>Model Validation</h2>
    <figure>
      <img src="images/1.h.jpeg" alt="Residuals and QQ plot">
      <figcaption>Figure 7: Residuals vs fitted values and QQ-plot.</figcaption>
    </figure>

    <figure>
      <img src="images/1.hh.jpeg" alt="Leverage and influential points">
      <figcaption>Figure 8: Leverage and influential points.</figcaption>
    </figure>

    <h3>Table 11: Normality and Independence Tests</h3>
    <table>
      <thead><tr><th>Test</th><th>P-value</th><th>Reject H₀</th></tr></thead>
      <tbody>
        <tr><td>Shapiro-Wilk</td><td>0.581</td><td>NO</td></tr>
        <tr><td>Durbin-Watson</td><td>0.401</td><td>NO</td></tr>
      </tbody>
    </table>
  </section>

  <section>
    <h2>Prediction Interval</h2>
    <p>
      Table 12 presents a 96% prediction interval for the first observation (observed BP = 105 mmHg).
    </p>
    <h3>Table 12: 96% prediction interval</h3>
    <table>
      <thead><tr><th>fit</th><th>lwr</th><th>upr</th></tr></thead>
      <tbody><tr><td>104.76</td><td>103.74</td><td>105.79</td></tr></tbody>
    </table>
  </section>

</body>
</html>


