<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Blood Pressure Analysis Project</title>
  <style>
    body { font-family:'Poppins', sans-serif; background:#f9f9f9; color:#333; margin:0; padding:20px; line-height:1.7; }
    nav { background:#111; padding:15px; text-align:center; }
    nav a { color:white; margin:0 15px; text-decoration:none; font-weight:bold; }
    nav a:hover { color:#fda085; transition:0.3s; }
    section { margin-bottom:40px; }
    img { max-width:100%; border-radius:10px; margin:20px 0; }
    h1, h2 { color:#111; }
    pre { background:#eee; padding:15px; border-radius:10px; overflow-x:auto; }
    figure { margin: 20px 0; }
    figcaption { font-size:0.9rem; color:#555; text-align:center; }
  </style>
</head>
<body>

  <!-- Navigation -->
  <nav>
    <a href="index.html">Portfolio</a>
    <a href="cv.html">CV</a>
  </nav>

  <h1>Blood Pressure Analysis Project</h1>

  <section>
    <p>
      This project explores the relationship between blood pressure (BP, in mm Hg) and several explanatory variables in 20 individuals with high blood pressure. The predictors include age, weight, body surface area (BSA), duration of hypertension, basal pulse, and stress index. The main goal is to identify which factors significantly influence blood pressure and construct predictive models.
    </p>
  </section>

  <section>
    <h2>Initial Data Analysis</h2>
    <p>
      The initial analysis included numerical and graphical summaries. There were 20 observations and 8 variables. No missing values were found. Figure 1 shows a graphical overview of all explanatory variables. We observed a bell-shaped distribution for blood pressure around 115 and no unusual patterns in Figure 2.
    </p>

    <figure>
      <img src="images/1.dataanalis.jpeg" alt="Overview of all explanatory variables">
      <figcaption>Figure 1: Overview of all explanatory variables with respect to index.</figcaption>
    </figure>

    <figure>
      <img src="images/1.first.jpeg" alt="Kernel density and index plot">
      <figcaption>Figure 2: Kernel density estimate (left) and index plot (right).</figcaption>
    </figure>

    <p>
      Based on the pairwise scatter plot in Figure 3, BP appeared to follow similar patterns as age, weight, and BSA. BSA and Weight were correlated, which will be considered in later model building.
    </p>

    <figure>
      <img src="images/1.corrplot.jpeg" alt="Pairwise scatter plot">
      <figcaption>Figure 3: Pairwise scatter plot to detect potential collinearity between variables.</figcaption>
    </figure>
  </section>

  <section>
    <h2>R Code – Data Exploration</h2>
    <pre><code>
# Load dataset and libraries
library(esquisse)
library(ggplot2)
library(leaps)
library(faraway)
library(stats)

bloodData <- read.table('blood.txt', header=T)
bloodData$Pt <- NULL
str(bloodData)

# Visualize response variable
par(mfrow=c(1,2))
plot(density(bloodData$BP, na.rm=TRUE), main="")
plot(sort(bloodData$BP))

# Explore explanatory variables
par(mfrow=c(2,3))
plot(bloodData$Age); plot(bloodData$Weight); plot(bloodData$BSA)
plot(bloodData$Dur); plot(bloodData$Pulse); plot(bloodData$Stress)

# Check collinearity
pairs(bloodData[,1:7], pch=1, cex=0.9, lower.panel=NULL)
cor(bloodData)
    </code></pre>
  </section>

  <section>
    <h2>Model Building and Regression Analysis</h2>
    <p>
      Six simple linear regression models were fitted with BP as the response and each predictor individually. The predictor with the strongest correlation was selected based on R² and residual inspection. Statistical significance was evaluated using t-tests at α = 0.05.
    </p>
    <p>
      A multiple regression model including all predictors was then fitted. Coefficients and p-values identified significant variables. BIC stepwise selection simplified the model, and VIF analysis addressed multicollinearity. Comparisons of all models (simple, full, BIC-reduced, VIF-adjusted) were done using R², F-tests, and ANOVA.
    </p>
  </section>

  <section>
    <h2>R Code – Regression</h2>
    <pre><code>
mdl <- lm(BP ~ Age, data=bloodData)
mdl2 <- lm(BP ~ Weight, data=bloodData)
mdl3 <- lm(BP ~ BSA, data=bloodData)
mdl4 <- lm(BP ~ Dur, data=bloodData)
mdl5 <- lm(BP ~ Pulse, data=bloodData)
mdl6 <- lm(BP ~ Stress, data=bloodData)

summary(mdl2)  # Best simple model

# Residual analysis
res <- resid(mdl2)
hist(res)
plot(fitted(mdl2), res, main="Residuals vs Fitted", ylab="Residual")
abline(0,0)

# Plot regression line with data
plot(BP ~ Weight, data=bloodData, main="BP vs Weight with regression")
abline(mdl2)
    </code></pre>
  </section>

  <section>
    <h2>Model Validation and Prediction</h2>
    <p>
      The final model underwent validation: residual plots for constant variance, Q-Q plots and Shapiro-Wilk test for normality, and Durbin-Watson for independence. Leverage points, outliers, and influential observations were identified via hat-values, studentized residuals, and Cook's distance.
    </p>
    <p>
      Finally, the model predicted the blood pressure of the first individual in the dataset, with a 95% prediction interval to account for uncertainty.
    </p>
  </section>

</body>
</html>


